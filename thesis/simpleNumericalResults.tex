% !TEX root = _individual/simpleNumericalResults.tex

% Copyright (c) 2011 Seth R. Johnson
% Licensed under Creative Commons BY-CC
% http://creativecommons.org/licenses/by-nc/3.0/

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Numerical Results: Linear Test Problems}\label{chap:simpleNumericalResults}

When the anisotropic diffusion equations are solved numerically, the solution
is not just a function of the physical problem: it is also affected by the
choice
of low-order discretization scheme, the transport discretization used in
calculating the AD coefficients, the transport convergence criteria, and many
other parameters.
Because our work is the first to use \SN-generated anisotropic diffusion
coefficients, we need to ensure that the chosen parameters and
discretizations give accurate answers in simple problems, before running
complex problems with time dependence and nonlinear opacities.

Furthermore, because of the novelty of the
flatland geometry, which we use extensively, it is also necessary to provide
numerical validation for the flatland boundary conditions derived in
Chapter~\ref{chap:flatland}.

In this chapter, we investigate the quality of the
anisotropic diffusion (AD), flux-limited anisotropic diffusion (FLAD), and
anisotropic \Pone\ (\APone) methods by analyzing their behavior in relatively
simple steady-state
and time-dependent problems. Most of these problems emulate attributes of
realistic thermal radiative transfer problems, viz.~high scattering ratios and
optically thin regions surrounded by optically thick regions.

Our numerical simulations are executed with several existing methods
(discussed more thoroughly in Chapter~\ref{chap:trtBackground}), as well
as the new anisotropic diffusion methods. All
are implemented in the \pytrt\ research code \cite{Pytrt}. Unless otherwise
noted, we use the following solver parameters with each method.
\begin{description}
  \item[The Monte Carlo method] functions as the benchmark transport method. Our
    implementation uses stratified sampling of source regions, and weight
    windows that attempt to keep uniform the weight of particles both emitted
    from sources and transported through previous time steps. The solver runs
    $10^7$ particles and uses path length--weighted tallies.

  \item[Standard diffusion] in our implementation uses a cell-centered
    discretization \cite{Dud1976}.  We use ``variational''
    [Eq.~\eqref{eq:flatVarBc}] rather than the less
    accurate ``Marshak'' [Eq.~\eqref{eq:flatMarshak}] boundary conditions.
    As with the following diffusion-like methods, we explicitly
    construct a sparse matrix that is passed to the Trilinos library
    \cite{Her2003}.  In steady-state problems with fewer than 50,000 unknowns,
    we use the KLU direct solver \cite{Her2003}; otherwise, we use the method
    of conjugate gradients (CG).

  \item[Time-dependent \Pone] uses the standard ``staggered mesh''
    discretization, in which the unknowns are a cell-centered $\phi$ and
    a face-centered $\vec{F}$.

  \item[Flux-limited diffusion] is implemented with the ``square root'' limiter
    and discretization scheme discussed in \S\ref{sec:bgFld}. The limiter is
    treated semi-implicitly; i.e., the nonlinear flux-limited diffusion
    coefficient is not converged. (This is common practice.) The unknowns and
    diffusion coefficients are stored as cell-centered data.

  \item[Anisotropic diffusion] uses
    coefficients calculated with the diamond difference \SN\ meth\-od,
    performing up to 100 sweep iterations.\footnote{%
      As a reminder, only one sweep is needed in the absence of boundaries
      because the transport problem is purely absorbing. Opposing reflecting
      boundaries may require many iterations to converge, so we have chosen a
      very large number of sweeps to ensure the AD coefficients are calculated
      accurately. A more realistic number of sweeps would be two or three if
      white boundaries are used and the problem is not minuscule in extent.
    }
    In flatland, we use a Chebyshev--Gauss quadrature set
    (see \S\ref{sec:flatlandQuadrature}) with 64 ordinates (S$_{32}$).
    %In 1-D, we use a Gauss--Legendre quadrature set with 16 ordinates
    %(S$_{16}$); 
    As with FLD, the opacities, diffusion coefficients, and unknowns are
    cell-centered. We use the nine-point stencil given in
    \S\ref{sec:cellAnisoA}. The low-order boundary conditions
    [Eq.~\eqref{eq:loBc}] use the variational extrapolation distance.

  \item[Flux-limited anisotropic diffusion] is implemented with the
    ``max'' limiter described in \S\ref{sec:flad} using the flux limiter
    discretization of \S\ref{sec:bgFld}. Otherwise, it is treated identically to
    the above anisotropic diffusion method.

  \item[Anisotropic \Pone] uses the same ``staggered mesh'' discretization
    as \Pone. In all other aspects, it is identical to the other anisotropic
    methods.

\end{description}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Analysis of non-analytic AD coefficients}

In prior work, the anisotropic diffusion coefficients were calculated using
analytic solutions of $f$ \cite{Lar2009c}. However, in all but the simplest
problems, such solutions are not available, so here we use an \SN\ transport
solver to
calculate the coefficients. Because \SN\ is only an approximation to the
transport equation, discretization in both the spatial and angular variables
will affect the calculated diffusion coefficients $\Dtens$, which in turn affect
the anisotropic diffusion solution $\phi$.

To assess the discrepancy in the solution incurred by using discrete transport,
we compare the solutions of a simple test problem using \SN-calculated
coefficients and analytically calculated coefficients. Furthermore, we compare
the analytic and discrete solutions to a Monte Carlo reference solution, to see
if the discrepancy in the diffusion coefficients affects the accuracy of
the methods.

By varying the number of ordinates in the quadrature set, the spatial
refinement in the \SN\ calculation, the \SN\ convergence criteria, and the
choice of boundary conditions for the calculation of $f$ (reflecting or white),
we determine acceptable solver parameters for later, more complex
problems.  A
voided channel surrounded by a diffusive, optically thick medium is
representative of many of our later test problems.

\subsection{Problem description}

The prototypical anisotropic diffusion test problem, a flatland VHTR mock-up
considered by Larsen and Trahan \cite{Lar2009c}, consists of voided vertical channels in a
diffusive medium. The diffusive region has $\sigma_d=1$, the channel
$\sigma_c=0.01$. The scattering ratio is uniformly $0.99$.  We use a small
portion of this problem (Fig.~\ref{fig:ssSingleXsn}), a single channel of unit
%
\begin{figure}[tb]
  \centering
  \includegraphics{ss_single_channel/xsn-enhanced}
  \Caption{The single channel problem configuration.}{
  The total opacity is plotted in black and white, and the colored region in the
  lower left is the Gaussian source.}
  \label{fig:ssSingleXsn}
\end{figure}
%
width, with diffusive regions on the left and right each with width 4. The left
and lower boundaries are reflecting, and the right and upper boundaries are
vacuum. The source is a Gaussian function peaked at $(0,0)$,
\begin{equation*}
  q(x,y) = 2 \eexp^{-2 (x^2 + y^2)}\,.
\end{equation*}

The analytic solution of the purely absorbing transport solution for this
problem is derived in Ref.~\cite{Lar2009c} and restated here:
\begin{equation}\label{eq:ssSingleAnalytic}
  f(x,y,\omega)
  = \frac{1}{2\pi \sigma_d}
  + \frac{1}{2\pi} \left( \frac{1}{\sigma_c} - \frac{1}{\sigma_d} \right)
  \times g(x - 4.5,\omega)\,,
\end{equation}
where $g(x,\omega)$ is given in Table~\ref{tab:ssSingleAnalytic}.

\begin{table}[htb]
  \centering
  \begin{tabular}{rll}
\toprule
& Voided region ($\abs{x} < W$) & Diffusive region ($\abs{x} > W$)
\\ \midrule
  $0 \le \omega < \frac{\pi}{2}$
&
  $1 - \eexp^{ - \sigma_c (W + x) / \cos \omega}$
& 
  $\eexp^{ - \sigma_d (x - W) / \cos \omega} \times
  \left( 1 - \eexp^{ - \sigma_c (2W) / \cos \omega} \right)
  $
\\
  $\frac{\pi}{2} < \omega \le \pi$
&
  $1 - \eexp^{ - \sigma_c (W - x) / \abs{ \cos \omega} }$
&
$0$
\\ \bottomrule
  \end{tabular}
  \Caption{Component $g(x,\omega)$ of the analytic solution of $f$ in the
  single-channel problem.}{
      Here, $\sigma_c$ and $\sigma_d$ are the total opacity in the
      channel and diffusive region, respectively; and $W=0.5$ is the half-width
      of the channel.
      Because the problem is symmetric, $g(x, \omega) = g(x, 2\pi - \omega)$ for
      $\omega < \pi \le 2\pi$.
    }
  \label{tab:ssSingleAnalytic}
\end{table}

This solution for $f$ is based on the assumption that the channel is
infinite in extent along the $y$ axis, and that the diffusive regions are
infinitely wide. We therefore expect reflecting boundaries on the \SN\ transport
problem for $f$ to produce answers closer to the analytic values. However, since
the channel is \emph{not} indeed infinite, reflecting boundaries will not
necessarily produce more accurate answers compared to the reference transport
solution.

Using the analytic solution for $f$ given in
Eq.~\eqref{eq:ssSingleAnalytic}, we calculate exact (to machine precision)
solutions for the anisotropic diffusion coefficient $\Dtens$
[from Eq.~\eqref{eq:flatDDefinition}]:
\begin{equation*}
  \Dtens(x,y) \equiv \int_{0}^{2\pi} \vec{\Omega} \vec{\Omega}
  f(x,y, \vec{\Omega}) \ud\omega \,,
\end{equation*}
as well as the boundary coefficient $\vec{d}$
[from Eq.~\eqref{eq:flatAdBoundaryIntegral}]:
\begin{equation*}
  \vec{d}(x,y) = -4\int_{\vec{\Omega}\vd\vec{n} < 0}
  V(\abs{\vec{\Omega}\vd\vec{n}})
\vec{\Omega} f(x,y, \vec{\Omega}) \ud\Omega\,.
\end{equation*}

All of the diffusion solutions, even though they may use analytically-calculated
coefficients, are solved using the standard five-point cell-centered diffusion
scheme%
\footnote{%
Because the opacity is symmetric about the $x$ axis, $D^{xy}=0$
throughout the problem; see \S\ref{sec:adLinalg}.
} using a uniform cell width of 0.0625.

\subsection{Solution}
The solution of the problem using four different methods is plotted in
Fig.~\ref{fig:ssSingleContour}. The Monte Carlo solution is the reference
solution.  We have also shown the anisotropic diffusion solutions with
both analytically calculated coefficients and \SN-calculated coefficients. The
latter uses reflecting boundaries on the transport calculation for $f$ with
$10^4$ source iterations. (Many sweeps are needed to fully converge the
opposing reflecting boundaries. Our goal is to determine the error introduced by
the \SN\ discretization itself, so we wish to reduce the additional error
incurred by
an incomplete \SN\ solution.) For comparative purposes, we also plot the
standard
diffusion solution.

Before exploring the parameter space of \SN\ solver options, we first point out
some features in the solution characteristic of anisotropic diffusion. Unlike
the Monte Carlo and diffusion solutions, which have discontinuous first
derivatives at the
boundary between channel and medium, the anisotropic diffusion solution is
smooth. The AD solution is less accurate near the material boundaries, but along
the centerline of the channel (Fig.~\ref{fig:ssSingleCenterline}) and a few mean
free paths into the medium, it matches the reference solution very closely.

\begin{figure}[htb]
  \centering
  \includegraphics{ss_single_channel/phi.pdf}
  \Caption{ Contour plot of $\phi$ in the steady-state single channel problem.}{
  The dashed black line is the reference Monte Carlo solution; the dotted red
  line is standard diffusion; the broken black line is anisotropic
  diffusion with analytic coefficients; the solid blue line is
  anisotropic diffusion with coefficients calculated with an S$_{32}$ transport
  sweep.}
  \label{fig:ssSingleContour}
\end{figure}

\begin{figure}[htb]
  \centering
  \input{ss_single_channel/phi-channel/plot}
  \Caption{Scalar intensity along $x=5.0$.}{
    The ``AD'' curve is the solution using analytic diffusion coefficients;
  the ``AD$_N$'' curves use S$_N$-calculated coefficients with reflecting
  boundaries.}
  \label{fig:ssSingleCenterline}
\end{figure}

\subsection{\texorpdfstring{\SN}{SN} parameter convergence}
Figure~\ref{fig:ssSingleAbsConv} plots the convergence of the solution $\phi$
against the solution with analytically-calculated AD coefficients, for four
different combinations of \SN\ solver parameters, as a function of the number of
source iterations (transport sweeps) in the calculation of $f$.

Likewise, figure~\ref{fig:ssSingleQsConv} plots the convergence of the \SN\ 
solution with increasing number of ordinates. The black line shows that refining
the quadrature brings the solution closer to the analytic value, but the red
line demonstrates that it does \emph{not} converge to the Monte Carlo transport
solution. This is expected: the anisotropic diffusion method is only an
approximation; based on assumptions about the problem's physics,
asymptotically small terms were discarded (see \S\ref{sec:adInterior}).
Yet in and around the channel
region in this problem, the discarded terms are probably not asymptotically
small. The true solution is strongly anisotropic and has
strong gradients at the channel interface. The assumptions underlying diffusion
also are not strictly valid at points in this problem.
However, unlike diffusion, anisotropic diffusion yields reasonable answers in
the presence of voids.

\begin{figure}[htb]
  \centering
  \subfloat[Source iterations]{%
    \label{fig:ssSingleAbsConv}
    \hspace{-.3in}%
    \input{ss_single_channel/absconv/plot}}%
    \hspace{.1in}%
  \subfloat[Quadrature sets]{%
    \label{fig:ssSingleQsConv}
    \hspace{-.3in}%
    \input{ss_single_channel/qsconv/plot}}%
    \hspace{.1in}%
  \Caption{Convergence of $\phi$ as a function of \SN\ parameters.}{
    The AD solution $\phi$ with \SN-calculated coefficients is compared
    against the solution with analytic coefficients using a volume-weighted
    2-norm, as a function of increasing source iterations in the calculation of
    $f$. The red line in (b) shows convergence compared to the Monte Carlo
    solution.}
  \label{fig:ssSingleConv}
\end{figure}

The convergence is calculated using a volume-weighted relative 2-norm:
\begin{equation}\label{eq:rel2norm}
  \text{reported difference} =
  \left[ \sum_{i \in \text{cells}} \left(
  \frac{\phi_i}{\phi_{i,\text{reference}}} - 1 \right)^2 (V_i)^2\right]^{1/2} \,.
\end{equation}
This is \emph{not} the convergence of the transport solution $f$, which only
affects $\phi$ indirectly.
Compared to the reference solution, AD (with analytic coefficients) has a 4.5\%
absolute error, and standard diffusion has a 19.8\% error.

The data in Fig.~\ref{fig:ssSingleAbsConv} suggest that with a finite number of
ordinates, which cannot exactly
approximate the angular domain, there is little added benefit to using more than
a few sweeps: the error introduced by the angular approximation exceeds that
caused by 
the lack of convergence. But Fig.~\ref{fig:ssSingleQsConv} shows that, since
the analytic AD solution differs from the exact solution by ~5\%, even a
coarse quadrature set can provide accuracy within the inherent limits of the
method.
%Additionally, the choice of reflecting or white boundary conditions has
%little effect on the solution of this problem.

This conclusion may not hold for all problems, of course, but it suggests that
a modest number of ordinates and sweeps are sufficient to yield solutions with
close to the accuracy of an analytic anisotropic diffusion solution.

\subsection{Coarse spatial grid calculation of \texorpdfstring{$\Dtens$}{D}}
\label{sec:coarseGridAdCoeff}

In addition to investigating the sensitivity of the AD solution to the
granularity of
the angular variable in the solution of $f$, we test the discrepancy
introduced by calculating $f$ on a coarser spatial grid. As discussed in
\S\ref{sec:adSmoothness}, the transport-calculated $f$ is a smooth function of
space, and
$\Dtens$ likewise has no discontinuities. We have implemented the basic
multigrid operations of prolongation and restriction in the \pytrt\ code
\cite{Pytrt}
for quantities located at the center of cells (i.e., $\sigma$ and $\Dtens$) and
at the external problem boundary faces (i.e., $\vec{d}$).

%The total opacity is restricted using a volume-weighted harmonic average 
We run the transport calculation for $f$ on a coarse grid and prolongate the
diffusion tensor $\Dtens$ and boundary coefficient $\vec{d}$ back to the fine
grid, in which $\phi$
is then solved. With this methodology, the spatial discretization error of the
diffusion solve is unaffected; the only difference is that the diffusion
coefficients are coarser functions of space. Figure~\ref{fig:ssSingleMgD} shows
the resulting coarse anisotropic diffusion coefficients.

\begin{figure}[htb]
  \centering
\subfloat[$D^{xx}$]{%
  \includegraphics[width=3in]{ss_single_channel/mg-dxx.png}}%
\subfloat[$D^{yy}$]{%
  \includegraphics[width=3in]{ss_single_channel/mg-dyy.png}}%
  \Caption{Calculated diffusion coefficients for different grid coarseness.}{
  Every two units downward represents a factor of four refinement in the
  number of fine cells per coarse cell.}
  \label{fig:ssSingleMgD}
\end{figure}

Figure~\ref{fig:ssSingleMgConv} plots the error in $\phi$ introduced by using
%
\begin{figure}[htb]
  \centering
  \input{ss_single_channel/mgconv/plot}
  \caption{Error introduced by coarse spatial grids in calculating the AD
  coefficients.}
  \label{fig:ssSingleMgConv}
\end{figure}
%
coarse approximations to the anisotropic diffusion coefficient. (In this
problem, the grid and refinements were chosen so that in the coarsest case, each
coarse cell was composed of a single material.) 
The rightmost data point in the figure has a coarse cell width of
$\Delta_x=0.5$, half the width of the channel.
In this simple problem with well-defined material boundaries, the
solution is relatively insensitive to using less spatially refined diffusion
coefficients. This is perhaps not surprising, since the standard
diffusion coefficient has no spatial variation inside a homogeneous material.

The implication of all these results is clear: high-fidelity transport
calculations are \emph{not} needed in calculation of the anisotropic diffusion
coefficients. Because the cost of the transport calculation is
roughly proportional to $
  (\text{the number of transport sweeps}) \times 
  (\text{the number of ordinates}) \times 
  (\text{the number of spatial cells})$,
using only a modest number of sweeps and a small quadrature set with a
coarse-grid calculation can provide a substantial speedup when compared with a
fine-grid calculation that might improve the answer only by a tenth of a
percent. Because we do not expect the anisotropic diffusion approximation to
yield exact transport solutions, and because a high-fidelity transport
calculation requires far more computational effort than a diffusion solve, the
small error incurred by using a coarse transport solution is justifiable in
light of the performance gain.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Flatland boundary conditions}\label{sec:nrFlatlandBcs}

The flatland boundary conditions derived in Chapter~\ref{chap:flatland} must,
for the sake of completeness, be numerically verified. We compare the novel
diffusion boundary conditions against a Monte Carlo reference solution in a
simple, diffusive test problem.

We consider a homogeneous flatland problem (Fig.~\ref{fig:flatlandBcProblem})
with a
total cross section $\sigma=1$ and scattering ratio $c=0.99$. The spatial 
domain is the rectangle $0 \le x \le 2$, $0 \le y \le 10$, with
reflecting boundaries on the left,
right, and top sides. The bottom side has a specified unit incident radiation
flux; we consider three different angular
distributions given in Table~\ref{tab:angularDistributions}.\footnote{These
distributions were chosen because of their prior use in a 1-D boundary
matching analysis in Ref.~\cite{Dav2006}.}

\begin{figure}[htb]
  \centering
  \includegraphics[width=4in]{flatlandbc-problem}
  \caption{Problem description for the flatland boundary test.}
  \label{fig:flatlandBcProblem}
\end{figure}

\begin{table}[htb]
  \centering
  \begin{tabular}{ccc}
\toprule
    Distribution & 1-D & Flatland
\\ \midrule
Isotropic & $I(\mu) = \frac{1}{2}$ & $I(\omega) = \frac{\pi}{2}$
\\
Normal & $I(\mu) = \delta(\mu-1)$ & $I(\omega) = \delta(\omega-\pi/2)$
\\
Grazing & $I(\mu) = \delta(\mu-0.1)$ & $I(\omega) = \delta(\omega-\sin\inv.1)$
\\ \bottomrule
  \end{tabular}
  \caption{Angular distributions used in boundary condition tests.}
  \label{tab:angularDistributions}
\end{table}

Figure~\ref{fig:flatlandBcDelta},
 a line-out of the scalar intensity $\phi_0$ along
$x=1$ for the normally incident boundary, illustrates the differences between
the methods. The diffusion
approximation cannot reproduce the boundary layer that the true transport
solution features, but the variational approximation to the flatland
diffusion boundary condition allows the asymptotic diffusion solution to
closely match the transport solution in the interior of the system. The Marshak
boundary condition does not have this desirable property.

Figure~\ref{fig:flatlandBcRelative} quantitatively compares both ``variational'' and
``Marshak'' diffusion boundary conditions against the transport solution
for all three incident distributions.  
As with the variational boundary condition for 3-D geometry, the flatland
variational boundary condition gives an interior scalar intensity accurate to within
a few percent. The Marshak condition fails to limit to the transport solution except in
the case of an isotropic boundary source, in which case only the extrapolation
distance differs from the variational boundary condition.

\begin{figure}[tb]
  \centering\small
  \hspace{-.25in}%
  \input{flatlandbc-channel/delta-phi/plot}
  \caption{Scalar intensity with a normally incident boundary condition in a
  homogeneous flatland problem.}
  \label{fig:flatlandBcDelta}
\end{figure}
 
\begin{figure}[tb]
  \centering\small
  \hspace{-.25in}%
  \input{flatlandbc-channel/relative-errors/plot}
  \caption{Relative errors ($\phi/\phi_\text{MC} - 1$) of the three tested
  distributions.}
  \label{fig:flatlandBcRelative}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\thesisclearpage
\section{Anisotropic diffusion boundary conditions}

In Chapter~\ref{chap:adDerivation}, we derived boundary conditions for the
anisotropic diffusion approximation. These boundary conditions reduce to the
standard diffusion boundary condition in a homogeneous medium, but they were
derived under a different set of asymptotic assumptions. We test the extent of
their applicability using two steady-state flatland test problems similar to
the previous voided channel test problem.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Interior source}

The first test of the anisotropic diffusion boundary conditions is a highly
scattering problem with a spatially smooth source in the interior. A vacuum
boundary in the problem serves as the primary sink for particles in the
problem; we therefore expect the global solution to be sensitive to the choice
of boundary conditions.

\subsubsection{Problem description}

The test problem (Fig.~\ref{fig:bcReactorProblem}) is similar to the above
%
\begin{figure}[htb]
  \centering
  \includegraphics{adbc-reactor/xsn-enhanced}
  \Caption{Steady-state AD boundary condition test problem.}{
    The black region is diffusive ($\sigma=1$, $\sigma_s=0.99$), the white
    region is optically thin ($\sigma=0.01$, $\sigma_s=0.0099$). The colored
    region in the lower-left is the Gaussian source.}
  \label{fig:bcReactorProblem}
\end{figure}
%
flatland boundary condition test
problem. It features a diffusive medium in flatland on the domain $0
\le x \le 5$ and $0 \le y \le 10$, with a channel of unit width running
vertically through the middle ($2.5 \le x \le 3.5$). The diffusive region has
$\sigma=1$ and $\sigma_s=0.99$, and the channel has $\sigma=0.01$ and
$\sigma_s=0.0099$. The bottom, left, and right boundaries are reflecting; the
top is a vacuum boundary.

The source is an isotropic Gaussian-shaped radiation source in the lower-left
corner:
\begin{equation*}
  q(x,y) = 2 \eexp^{-2 (x^2 + y^2) } \,.
\end{equation*}
The spatial mesh has the grid spacing $\Delta_x = \Delta_y = 0.1$.

We compare a Monte Carlo solution, a diffusion solution, and three instances of
anisotropic diffusion with different choices for the boundary condition on the
vacuum boundary. Only two---the white and reflecting
conditions---satisfy Eq.~\eqref{eq:hoBc}. The ``na\"ive'' boundary condition
sets the incident values of $f$ to zero and uses the Marshak diffusion boundary
condition from Eq.~\eqref{eq:flatMarshakAdBc}. It serves to demonstrate the
importance of using theoretically sound boundary conditions.

\subsubsection{Results and discussion}

First, we plot $f$ (Fig.~\ref{fig:bcReactorF}) at the top of the problem for
the three alternative boundary conditions for the purely absorbing transport
problem. (The polar plots of $f$ are described in Fig.~\ref{fig:polarPlot}.)
%
\begin{figure}[tb]
  \centering
  \subfloat[$f(2.5,10,\omega)$]{%
    \hspace{-.25in}%
    \input{adbc-reactor/adf-center-ymax/plot}%
   \label{fig:bcReactorFchan}%
  }%
  \subfloat[$f(1.5,10,\omega)$]{%
    \hspace{-.25in}%
    \input{adbc-reactor/adf-insideleftedge-ymax/plot}
  }%
  \Caption{Polar plots of the purely absorbing transport solution at two points
    in at the end of the channel.}{
  The solution as a function of azimuthal angle $\omega$ is plotted (a) at the
  center of the channel (where $f$ is the strongly anisotropic) and (b) further
  from material discontinuities (where $f$ tends toward isotropy).
  }
  \label{fig:bcReactorF}
\end{figure}
%
\begin{figure}[htb]
  \centering
  \includegraphics[width=3.25in]{polar-plot}
  \Caption{Cartoon describing the polar plots of $f$.}{
  The gray bars depict the location of the diffusive regions
  relative to the centerline of the channel. Directions near $\omega=\pi/2$ at
  $y=10$ are exiting the problem; directions in $\pi \le \omega < 2\pi$ are
  incident and therefore depend on the boundary conditions for $f$.}
  \label{fig:polarPlot}
\end{figure}
%
The effect of the boundary condition on $f$ is straightforward: a reflecting boundary
condition mirrors the angular distribution across the $x$ axis, and a white
boundary condition yields an isotropic distribution for incident angles. The
na\"ive boundary condition is positive only for exiting angles. For the sake of
comparison, the diffusion approximation $f(\vec{x},\vec{\Omega}) =
\frac{1}{2\pi \sigma(\vec{x})}$ could be plotted as a circle. (In
Fig.~\ref{fig:bcReactorFchan}, it would be out of range of the plot.) Both the
anisotropic diffusion tensor $\Dtens$ and the boundary coefficient
$\vec{d}$ change as a result of the boundary conditions.


\thesisclearpage

The different diffusion and boundary coefficients naturally cause the
anisotropic diffusion solutions $\phi$ to differ. Figure~\ref{fig:bcReactorFlux}
compares the three instances of anisotropic diffusion with the Monte Carlo
reference solution and the diffusion solution.

\begin{figure}[htb]
  \centering
  \hspace{-.25in}%
  \input{adbc-reactor/phi-channel/plot}
  \caption{Scalar intensity in the steady-state interior source problem.}
  \label{fig:bcReactorFlux}
\end{figure}

Clearly, anisotropic diffusion is superior to conventional diffusion for this
problem: the solution differs
from the reference solution by only a few percent globally. The two choices of
boundary conditions for $f$ consistent with Eq.~\eqref{eq:hoBc}, reflecting and
white, produce very similar answers. In contrast, the inconsistent choice of a
vacuum boundary for $f$ introduces a significant global error, even many mean
free paths away from the boundary.

To help understand the accuracy of anisotropic diffusion as compared to standard
diffusion, we have plotted in Fig.~\ref{fig:bcReactorAngular} the angular
intensity at several points in the problem as approximated by \SN, AD, and
standard diffusion. Whereas standard diffusion approximates the radiation as linear in
angle, anisotropic diffusion has much more \emph{shape}, resulting from the
(generally nonlinear)
anisotropy in $f$. As we asserted in Chapter~\ref{chap:adDerivation}, this extra
transport-derived information results in a more accurate approximation.

\begin{figure}[htb]
  \centering\small
  \subfloat[$I(2.5,0,\omega)$]{%
    \hspace{-.25in}%
    \input{adbc-reactor/angle-center-y0/plot}}

  \subfloat[$I(2.5,10,\omega)$]{%
    \hspace{-.25in}%
    \input{adbc-reactor/angle-center-ymax/plot}}%
  \subfloat[$I(1.55,5,\omega)$]{%
    \hspace{-.25in}%
    \input{adbc-reactor/angle-insideleftedge-y5/plot}}%
    \Caption{Polar plots of the angular intensity in the channel.}{
     The intensity as a function of azimuthal angle $\omega$ is shown at (a)
   the bottom center, (b) the top center, and (c) the middle left edge.}
  \label{fig:bcReactorAngular}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
\subsection{Boundary source}

The problems with an incident particle flux on the boundary potentially have
strong gradients and anisotropy outside the applicable range of the anisotropic
diffusion approximation. As an alternative test of the boundary conditions, we
consider three boundary source--driven problems.

\subsubsection{Problem description}

This test problem has opacities identical to the previous problem: two diffusive
regions surround an optically thin channel. However, rather than being driven
by an extraneous source, the problem has an incident radiation flux on the
bottom face. The top, left, and right sides are reflecting. We consider the same
incident angular distributions as in \S\ref{sec:nrFlatlandBcs}, given in
Table~\ref{tab:angularDistributions}: an isotropic
source, a normally-incident source, and a grazing source.

\subsubsection{Results and Discussion}

Figure~\ref{fig:adbcIsotropic} shows a line-out of the scalar intensity
$\phi(2.5,y)$
along the center of the channel in the isotropic incident case. Standard
diffusion fails because $\sigma=0.01$ leads to a
large diffusion coefficient, resulting in a nearly constant solution inside the
channel. Anisotropic diffusion performs quite well, and the
white boundary condition for $f$ gives a more accurate result than the
reflecting boundary condition. (The na\"ive boundary condition, as discussed in
the previous test problem, is inaccurate.)

\begin{figure}[tb]
  \centering
  \centering\small
  \hspace{-.25in}%
  \input{adbc-channel/isotropic-phi-channel/plot}
  \caption{Scalar intensity along the centerline of the channel with an
    isotropic
  boundary condition at $y=0$.}
  \label{fig:adbcIsotropic}
\end{figure}

The AD approximation and its boundary conditions do have their limits. In the
case of a strongly anisotropic boundary source, the ansatz that
$\vec{F} = O(\epsilon)$ is violated in swaths of the problem, so the solutions
for the normal and grazing boundary conditions have large errors
(Fig.~\ref{fig:adbcRelErr}).

\begin{figure}[tb]
  \centering
  \centering\small
  \hspace{-.25in}%
  \input{adbc-channel/relative-errors/plot}
  \caption{Relative errors along the centerline of the channel with the three
  different incident boundary conditions.}
  \label{fig:adbcRelErr}
\end{figure}

A visualization of the angular intensity for each method (replacing Monte Carlo with
an \SN\ solution), Fig.~\ref{fig:bcChannelIsotropicAngular}, helps explain the
accuracy
of the AD method and the difference between the reflecting and white boundary
treatments. Even though AD cannot exactly model the peak of freely streaming
photons in the channel (which the \SN\ angular intensity shows at $\omega=3\pi/2$),
it accurately approximates the shape driven by scattering from the
diffusive region (the lobes on the left and right) in the isotropic incident
case. In the strongly anisotropic (normal incident source) case, where
uncollided particles from the boundary dominate the scattered particles,
anisotropic diffusion cannot accurately approximate the particle
distribution in the channel.
The linear-in-angle diffusion approximation cannot represent any of these
features.

\begin{figure}[htb]
  \centering\small
  \subfloat[Isotropic]{%
  \label{fig:bcChannelIsotropicAngular}
  \input{adbc-channel/angle-isotropic-center-y1/plot}%
  \vspace{-.25in}%
  }%
  \subfloat[Normal]{%
  \label{fig:bcChannelDeltaAngular}
  \input{adbc-channel/angle-delta-center-y1/plot}%
  \vspace{-.25in}%
  }%
  \Caption{Angular intensity $I(2.5, 1, \omega)$ in the incident boundary source
  problem.}{
  The isotropic (a) and normal (b) incident cases are plotted in the centerline
  of the channel, one unit from the boundary.}
  \label{fig:bcChannelAngular}
\end{figure}

The shape around $\omega=\pi/2$ gives insight into why the white boundary
performs slightly better in the case of an isotropic incident boundary
condition: a reflecting boundary produces a peak in $f$
along the channel, but a white boundary gives a more isotropic shape near that
range, better matching the incident isotropic boundary condition. This suggests
that the qualitatively best way to satisfy Eq.~\eqref{eq:hoBc} may be
to require the incident distribution of $f$ to take the shape of the true
boundary condition.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Smooth time-dependent problem}

Before testing the new time-dependent anisotropic diffusion methods in
nonlinear thermal radiative transfer problems, we
examine their behavior in a more simple
situation: linear, time-dependent problems with time-independent opacities.

In this first time-dependent problem, we expect the temporal and spatial
gradients to be moderate but significant enough to distinguish diffusion from
transport.

\subsection{Problem description}

This smooth problem features a unit source in the bottom left corner of a
highly scattering medium of width~$2$ with
$\sigma=1$ and $\sigma_s=0.99$. A voided region with width $0.5$,
$\sigma=0.01$, and $\sigma_s=0.0099$ lies along the right edge of the problem.
The bottom,
left, and right boundaries are reflecting; the top of the problem has a vacuum
boundary. The problem's initial condition is uniformly zero, and the particle
speed is unity ($c=1$).

Because this problem is time-dependent, it is the first test of the anisotropic
\Pone\ method devised in Chapter~\ref{chap:aponeDerivation}. This method
uses not only the anisotropic diffusion tensors $\Dtens$ but also a nonlocal
opacity $\varsigma$, as formulated in \eqref{eq:ap1FicksLawFinal}:
\begin{equation*}
  \frac{1}{c}\pder{\vec{F}}{t}(\vec{x},t)
  + \varsigma(\vec{x}) \Dtens(\vec{x}) \vd \grad \phi(\vec{x}, t)
  + \varsigma(\vec{x})\vec{F}(\vec{x},t) 
  = 0 \,.
\end{equation*}
Figure~\ref{fig:tdReactorProblem} overlays these transport-calculated
coefficients on the problem's physical description.

In this figure, the anisotropic diffusion tensors are plotted as ellipses. Each
ellipse's major axis
lies along the principal eigenvector of $\Dtens$, and the size along that axis is
proportional to the corresponding eigenvalue. The minor axis is proportional to
the second eigenvalue of the tensor. If $f$ is isotropic, $\Dtens$ is
proportional to the identity tensor, and its two eigenvalues are equal: thus, in
the interior, the anisotropic diffusion coefficients appear as circles whose
sizes are proportional to $1/\sigma$. In the channel, where $f$ is strongly
anisotropic, the ellipses show that the primary action of the diffusion
tensor is along the channel.

\begin{figure}[tb]
  \centering
  \includegraphics[width=1.5in]{td_reactor/xsn}
  \Caption{Time-dependent smooth problem properties.}{
    The source region is the red square in the lower-left; the grey
    and white area in the bottom half shows $\sigma$, the colored region above
    shows $\varsigma = 1/\int_{S} f \ud\Omega$, and the ellipses are a
    visualization of the diffusion tensor $\Dtens=\int_{S}
    \vec{\Omega}\vec{\Omega} f \ud\Omega$.}
  \label{fig:tdReactorProblem}
\end{figure}

\subsection{Results and Discussion}

The large phase space of time-dependent transport forces us to carefully choose
representative metrics. We use contour plots to compare select methods at
select times, lineouts to compare more methods in greater detail, and wavefront
plots to visualize the detailed time evolution of the problem.

The behavior of $\phi$ along the center of the channel (i.e., at the
right edge of the problem) is plotted in Fig.~\ref{fig:tdReactor}. Anisotropic
diffusion and conventional diffusion, which both assume a quasi-static problem,
are significantly less accurate and are not plotted in that figure. Their
more accurate flux-limited counterparts, FLAD and FLD, are shown instead.

\begin{figure}[tb]
  \centering\small
  \subfloat[$t=2$]{%
    \hspace{-.25in}%
    \input{td_reactor/lineout-phi-channel-2/plot}}%
  \subfloat[$t=5$]{%
    \hspace{-.25in}%
    \input{td_reactor/lineout-phi-channel-5/plot}}

  \subfloat[$t=10$]{%
    \hspace{-.25in}%
    \input{td_reactor/lineout-phi-channel-10/plot}}%
  \subfloat[$t=15$]{%
    \hspace{-.25in}%
    \input{td_reactor/lineout-phi-channel-15/plot}}

  \caption{Scalar intensity $\phi$ along the centerline of the channel, $y=2.5$.}
  \label{fig:tdReactor}
\end{figure}

None of the low-order methods exactly reproduces the transport solution. Even
with flux
limiting, FLD and FLAD overestimate the rate of particles flowing into the void.
However, as the problem tends toward steady-state, the anisotropic
methods become relatively accurate. (We recall that both FLAD and \APone\ limit
to the AD method when the solution varies slowly in time.)

As one diagnostic, we plot the ``wavefront'' positions---determined by the
location at which $\phi=0.001$ after applying a small amount of smoothing---for
all of the methods in Fig.~\ref{fig:tdReactorWavefront}. These plots again show
how FLAD and AD both overestimate the scalar intensity at early times, and they also
point to an explanation. Because the flux limiters are not iterated upon, the
solution of the first time step is the same as the standard diffusion
solution. (In Fig.~\ref{fig:tdReactorWavefrontLeft}, the flux-limited and
standard diffusion methods share a starting point.) As a result, the
flux-limited methods carry that artifact of non-flux-limited particles for all
later time steps. To obviate this error, shorter initial time steps (in which
the effective time absorption $1/c\Delta_t$ reduces the magnitude of the
precursor) could be used. Alternatively, the nonlinear flux-limited diffusion
coefficient could be converged.

\begin{figure}[htb]
  \centering\small
  \hspace{.25in}%
  \subfloat[Channel, $x=2.5$]{%
    \hspace{-.25in}%
    \input{td_reactor/wavefront-phi-channel/plot}}
  \subfloat[Medium, $x=0$]{%
    \label{fig:tdReactorWavefrontLeft}%
    \hspace{-.25in}%
    \input{td_reactor/wavefront-phi-left/plot}}
  \caption{Wavefront position along the $y$ axis.}
  \label{fig:tdReactorWavefront}
\end{figure}

A contour plot showing the difference between \Pone\ and \APone\ is given in
Fig.~\ref{fig:tdReactorContour}. The \APone\ solution is generally more accurate
%
\begin{figure}[htb]
  \centering%\small

  \subfloat[$t=2$]{%
    \hspace{.75in}\includegraphics{td_reactor/phi-002}\hspace{.75in}}%
  \subfloat[$t=5$]{%
    \hspace{.75in}\includegraphics{td_reactor/phi-005}\hspace{.75in}}

  \subfloat[$t=10$]{%
    \hspace{.75in}\includegraphics{td_reactor/phi-010}\hspace{.75in}}%
  \subfloat[$t=15$]{%
    \hspace{.75in}\includegraphics{td_reactor/phi-015}\hspace{.75in}}

  \Caption{Contour plots of the scalar intensity at four times.}{
    The black dashed line is the Monte Carlo solution, the blue solid line is
    the \APone\ solution, and the red dotted line is the \Pone\ solution.}
  \label{fig:tdReactorContour}
\end{figure}
%
than \Pone. As the system evolves in time, it becomes like the steady-state
channel problems analyzed earlier: diffusion (the steady-state limit of \Pone)
fails in these problems, so it is unsurprising that \APone\ outperforms \Pone\
at late times.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage

\section{Time-dependent blast wave}\label{sec:tdBlastwave}

Thermal radiative transfer problems often contain strong spatial and temporal
gradients. We consider a more stressful test of the different anisotropic
approximations to the transport equation.

\subsection{Problem description}

The ``blast wave'' test problem (Fig.~\ref{fig:tdBlastwaveXsn})
%
\begin{figure}[tb]
  \centering
  \hspace{-.5in}
  \includegraphics{td_blastpipe/xsn-enhanced}
  \Caption{Opacities and initial condition for the blast wave problem.}{
  The colored region is the isotropic initial condition $\phi_i$.}
  \label{fig:tdBlastwaveXsn}
\end{figure}
%
features a localized impulse of radiation; the
magnitude of the coefficients and the initial condition is based on a recurrent
test problem in the field
of thermal radiative transfer \cite{Kno1999a,Kno2001,Rau2005,Ols2007}. The
domain of this problem is $0 \le x \le 3$ and $-1.1 \le y \le 1.1$.
It features an optically thin channel with $\sigma=1$ and $\sigma_s=0.99$ inside
$-.1 \le y \le .1$, with a diffusive region $\sigma=10$ and $\sigma_s=9.99$
outside it. All boundaries are specularly reflecting.

The initial condition is a local but smooth Gaussian function:
\begin{equation*}
  \phi^i(x,y) = 0.001 + 100 \eexp^{-100 (x^2 + y^2) }\,.
\end{equation*}
We use a grid spacing of $\Delta_x=\Delta_y=0.02$, and a uniform time step
$\Delta_t=0.02$. As in the previous problem, the particle speed is $c=1$.

\subsection{Results and Discussion}

The isotropic initial condition is the only source of particles in this
problem. Because a majority of them are born in the optically thin channel,
those with directions close to the $+x$ axis will tend to stream down the
channel uncollided. This is the \emph{hyperbolic} behavior of the transport
equation: when $\sigma$ and sources are small, the Boltzmann equation reduces
to a wave equation.
Particles that enter the medium diffuse: this is \emph{parabolic} behavior. The
transport solution can be viewed as a combination of the hyperbolic and
parabolic solutions.

The final state ($t=3$) of the problem is plotted in Fig.~\ref{fig:tdBlastwave}.
Several features characteristic of the methods are apparent. First, only the
transport solution (Monte Carlo) contains the peak of uncollided particles at
$x=3$. Aside from that peak, the particles that have undergone
multiple collisions, the anisotropic diffusion methods all match reasonably
well. In this particular problem, flux-limited anisotropic diffusion is the most
accurate. The \Pone\ method fails even to produce a positive solution: this is a
known limitation of the method in multi-dimensional problems with strong spatial
and temporal gradients. Interestingly, the \APone\ solution is markedly better.
The smoothness of $\Dtens$ and $\varsigma$ as compared to $1/3\sigma$ and
$\sigma$ presumably obviate the strain on the wavelike behavior of the problem.

\begin{figure}[tb]
  \centering\small
  \subfloat[Along center]{%
    \hspace{-.25in}%
    \input{td_blastpipe/phi-center03-00/plot}}%
  \subfloat[Orthogonal view]{%
    \hspace{-.25in}%
    \input{td_blastpipe/phi-ortho03-00/plot}}%

  \caption{Scalar intensity at $t=3$ in the blast wave problem.}
  \label{fig:tdBlastwave}
\end{figure}

The time-dependent behavior of the transport solution (MC) and flux-limited
anisotropic diffusion (FLAD) is shown in Fig.~\ref{fig:tdBlastwaveAll}. At longer
times, the FLAD solution approaches the MC solution away from the uncollided
pulse of particles.

\begin{figure}[tb]
  \centering\small
    \hspace{-.15in}%
    \input{td_blastpipe/phi-all/plot}

  \caption{Comparison of Monte Carlo and flux-limited anisotropic diffusion at
  four times in the blast wave problem.}
  \label{fig:tdBlastwaveAll}
\end{figure}

Because the diffusion equations are inherently parabolic, they cannot capture
the behavior of the uncollided particles seen in the Monte Carlo solution.
However, the hyperbolic (diffusive) behavior is modeled more accurately with
the AD methods than with conventional diffusion methods. As we have seen in the
previous test problems, the linear-in-angle approximation of standard diffusion
is wholly inadequate in the interior of the channel, leading to an inaccurate
solution.

The timings for the blast wave problem, as run on a single core of a 2.4 GHz
Intel Core 2 Duo chip, are presented in Table~\ref{tab:tdBlastwaveTiming}. These
%
\begin{table}[htb]
  \centering
  \begin{tabular}{lr}
\toprule
    & Wall time (s)
\\ \midrule
MC & 790 \\
\APone & 31 \\
FLAD & 40 \\
AD & 38 \\
\Pone & 23 \\
FLD & 18 \\
Diffusion & 18
\\ \bottomrule
  \end{tabular}
  \caption{Timing comparison for the blast wave problem.}
  \label{tab:tdBlastwaveTiming}
\end{table}
%
give a rough idea of the relative performance of the standard diffusion methods,
the anisotropic diffusion methods, and the transport method. The initial
calculation of the anisotropic diffusion coefficients is amortized over the
subsequent time steps, so over longer times, the performance of the AD methods
asymptotically approaches the performance of the standard diffusion methods.


\subsection{Extended problem parameter space}
To quantitatively verify that the positive results in this problem are not
accidental, we parameterized the problem and extensively investigated the parameter
space.
Using Latin Hypercube Sampling \cite{McK1979}, we sampled 40 instances of
the above problem with the following parameters and corresponding distributions:
\begin{itemize}
  \item the width of the diffusive region (uniform on $[0,2]$);
  \item the width of the channel region (uniform on $[0,1]$);
  \item the sharpness of the Gaussian (exponential with $\lambda = 100$);
  \item the value of $\sigma$ in the diffusive region (uniform on $[1,20]$); and
  \item the value of $\sigma$ in the channel region (exponential with
    $\lambda=0.1$).
\end{itemize}

As a metric of error, we compared the volume-weighted
2-norm error (with the reference solution being a Monte Carlo simulation
using $10^6$ particles) along the channel centerline and a cross-section of the
problem at $x=0.3$ at the final problem time. (Other metrics yielded similar
results.)

The error distributions are plotted in Fig.~\ref{fig:tdBlastwaveParameterized}.
%
\begin{figure}[htb]
  \centering\small
  \subfloat[Channel centerline]{%
    \hspace{-.25in}%
    \input{td_blastpipe/errors-phi-center-t3/plot}}%
  \subfloat[Orthogonal line]{%
    \hspace{-.25in}%
    \input{td_blastpipe/errors-phi-ortho-t3/plot}}%

  \caption{Distributions of errors in the parameterized blast wave problem. The
  FLAD solutions are consistently accurate; the \Pone\ solutions are inaccurate
  with a wide range of inaccuracy.}
  \label{fig:tdBlastwaveParameterized}
\end{figure}
%
Distributions more peaked toward the left of the plot are more accurate, and
wider distributions indicate a method inconsistent in its accuracy. As one might
expect from the detailed discussion of one instance of the blast wave problem,
flux-limited anisotropic diffusion is the most accurate, and \Pone\ is the least
accurate.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions}

We have established and tested some approximations that undergird the rest of
our results.  First, we ensured that non-analytic (discrete
ordinates--calculated) AD coefficients do not compromise the accuracy of the
method. We also demonstrated that the number of sweeps required to converge a
transport-calculated $f$ is small enough to make an AD solution competitive.

With the linear numerical experiments in this chapter, we have verified the
theory developed in the previous chapters. The boundary conditions we proposed
for anisotropic diffusion in Chapter~\ref{chap:adDerivation} yield accurate
answers for our test problems in which the radiation is not strongly anisotropic
throughout the problem. The boundary conditions for flatland diffusion were also
successfully tested.

Finally, we performed the first test of time-dependent anisotropic diffusion. In
a wide variety of problems with optically thin channels, the anisotropic
diffusion methods (particularly flux-limited anisotropic diffusion) outperformed
their conventional counterparts.

With these encouraging results for linear, time-dependent problems, we move to
more difficult nonlinear problems in Chapter~\ref{chap:trtNumericalResults}.

